<link rel="import" href="../../../lib/polymer/polymer.html">
<link rel="import" href="../../../lib/core-icons/core-icons.html">
<link rel="import" href="../../../lib/paper-slider/paper-slider.html">
<link rel="import" href="../../../lib/core-localstorage/core-localstorage.html">


<polymer-element name="ss-control-sound" attributes="mutedImgSrc loudImgSrc">
    <template>
        <link rel="stylesheet" href="ss-control-sound.css"/>
        <core-localstorage name="Sound volume" value="{{soundVolumeLocalStorage}}"></core-localstorage>
        <core-localstorage name="Sound muted" value="{{soundMuted}}"
                           core-localstorage-load="{{localStorageDidLoad(event)}}"></core-localstorage>
        <template if="{{soundVolume > 0 }}">
            <paper-icon-button id="muteButton" on-click="{{muteButtonClick}}" src="{{loudImgSrc}}"></paper-icon-button>
        </template>
        <template if="{{soundVolume == 0 }}">
            <paper-icon-button id="unMuteButton" on-click="{{unMuteButtonClick}}"
                               src="{{mutedImgSrc}}"></paper-icon-button>
        </template>
        <paper-slider id="volumeSlider" pin min="0" max="100" value="{{soundVolume}}"
                      on-change="{{onVolumeChange}}"></paper-slider>
    </template>
    <script type="text/javascript">
        'use strict';
        (function () {
            Polymer({
                soundVolume: 100,
                soundVolumeLocalStorage: 100,
                soundMuted: false,
                localStorageDidLoad: function (event) {
                    if (this.soundMuted === false) {
                        this.soundVolume = this.soundVolumeLocalStorage;
                    }
                    console.log("loll")
                },
                muteButtonClick: function () {
                    this.soundMuted = true;
                    this.soundVolume = 0;
                },
                unMuteButtonClick: function () {
                    this.soundMuted = false;
                    this.soundVolume = this.soundVolumeLocalStorage;
                },
                onVolumeChange: function () {
                    if (!this.soundMuted) {
                        this.soundVolumeLocalStorage = this.soundVolume;
                    }
                }
            })
        })()
    </script>
</polymer-element>